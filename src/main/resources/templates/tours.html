<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tours</title>

    <link rel="stylesheet" href="/css/tourStyle.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore-compat.js"></script>


    <script src="/javascript/firebase-auth.js"></script>
</head>
<body onload="checkAuthCarbon()">

<div class="header"></div>
<div class="banner">
    <p class="toursp">Tours</p>
    <a class="offestp" href="/offsets">Offsets</a>
</div>
<div class="icon-container" onclick="toggleCollapsible()">
    <i class="fa-solid fa-user"></i>
</div>

<div class="content">
    <p id="userInfo" style="display: none;"></p>
    <div id="logoutSection" style="display: none;">
        <button class="logoutButton" onclick="logout()">Logout</button>
    </div>
</div>

<form class="newTour" id="makeNewTour" action="/newTour" method="get">
    <button class="box" type="submit">New Tour</button>
</form>
<br><br>

<h1>Past Tours</h1>

<div class="tours-container">
    <div th:each="tour : ${overTours}" class="boxTours"
         th:data-seats="${tour.noOfSeats}"
         th:data-concerts="${tour.noOfConcerts}"
         th:data-emissions="${tour.carbonEmissions}"
         th:data-transport="${tour.modesOfTransport}">
        <div class="tour-content">
            <h2 th:text="${tour.tourName}" class="tour-name">Tour Name</h2>
            <div class="tour-icons">
                <div class="icon-group">
                    <i class="fas fa-users"></i>
                    <p th:text="${tour.noOfConcerts}" class="concerts">10</p>
                </div>
                <div class="icon-group">
                    <i class="fas fa-shoe-prints"></i>
                    <p th:text="${tour.carbonEmissions} + ' kg CO₂'" class="carbon-emissions">500 kg CO₂</p>
                </div>
                <div class="icon-group">
                    <i class="fas fa-chair"></i>
                    <p th:text="${tour.noOfSeats}" class="seats">50</p>
                </div>
                <div class="transport-icons">
                    <i class="fas fa-bus transport" data-mode="bus"></i>
                    <i class="fas fa-plane transport" data-mode="plane"></i>
                    <i class="fas fa-car transport" data-mode="car"></i>
                    <i class="fas fa-train transport" data-mode="train"></i>
                </div>
            </div>
        </div>
    </div>
</div>


<script>
    function toggleCollapsible() {
        var content = document.querySelector(".content");
        var userInfo = document.getElementById("userInfo");
        var logoutSection = document.getElementById("logoutSection");

        if (content.style.display === "none" || content.style.display === "") {
            content.style.display = "block";
            userInfo.style.display = "block";
            logoutSection.style.display = "block";
        } else {
            content.style.display = "none";
            userInfo.style.display = "none";
            logoutSection.style.display = "none";
        }
    }

    document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".tour-box").forEach(tour => {
            let activeModes = tour.getAttribute("data-transport").split(",");
            tour.querySelectorAll(".transport").forEach(icon => {
                if (activeModes.includes(icon.getAttribute("data-mode"))) {
                    icon.classList.add("active");
                }
            });
        });
    });


</script>

</body>
</html>